{% extends "accounts/Admin/Budget_Officer/bo.html" %}


{% load static %}


{% block bohome %}




<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<style>

  .status{
    width: 30%;
    text-align: center;
  }


  .table a {
    text-decoration: none;
    color: black;
  }

  .bg-success {
    /* Your styles for a successful status */
    background-color: #b5e550; /* Adjust this to your desired background color */
    color: white; /* Adjust this to your desired text color */
}
  
</style>

<div class="container-fluid" style="height: 68vh; overflow-y: auto; overflow-x: hidden;">
  <h1 class="pr text-center pt-4">PURCHASE REQUESTS</h1>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th class="text-center">Date Requested</th>
        <th class="text-center">Requests</th>
        <th class="text-center">Purpose</th>
        
        <th class="status">Status</th>
        <th class="text-center"> Date</th>
      </tr>
    </thead>
    <tbody>
      {% for checkout in checkouts %}
      <tr>
        <td class="text-center">
          {{ checkout.submission_date }}
        </td>
        <td>
            <a href="{% url 'preqform_bo' pr_id=checkout.pr_id %}">
                <strong>{{ checkout.user.first_name }} {{ checkout.user.last_name }}</strong> submitted a new purchase request on {{ checkout.submission_date }}
            </a>
        </td>
        <td>
          {{ checkout.purpose }}
        </td>
        <td class="badge {% if checkout.is_approved %}bg-success{% else %}no-comment{% endif %}" style="margin-top: 5px; margin-left: 5px; color: black;">
          {% if checkout.is_approve %}
              Approved
          {% else %}
              Disapproved
          {% endif %}
        </td>
        <td>
          {{ checkout.status_update_date|default:"Not available" }}
        </td>
      </tr>
      <tbody>
        {% for item in feedback %}
          <tr>
            <td>{{ item.pr_id }}</td>
      
            <!-- Display the purpose from "preqform" or "bohome" -->
            {% for i in checkout_info %}
              {% if i.pr_id == item.pr_id %}
                <td>{{ i.purpose }}</td>
              {% endif %}
            {% endfor %}
      
            <td>Purchase Request Approval</td>
      
            <!-- Display the status and timestamp -->
            <td class="badge bg-success" style="margin-top: 5px; margin-left: 5px; color: white;">
              {% if item.status_comment %}
                {{ item.status_comment }}
              {% else %}
                {{ item.content }}
              {% endif %}
            </td>
      
            <td>{{ item.status_update_date|default:item.timestamp }}</td>
      
            <!-- Display the approval status -->
            <td class="badge {% if item.is_approve %}bg-success{% else %}no-comment{% endif %}" style="margin-top: 5px; margin-left: 5px; color: black;">
              {% if item.is_approve %}
                Approved
              {% else %}
                Disapproved
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      
        {% if feedback|length == 0 %}
          <tr>
            <td colspan="3">
              <span>NO REQUEST YET</span>
            </td>
          </tr>
        {% endif %}
      
      {% endfor %}
      
      
    </tbody>
  </table>
  
  
  
  
</div>


  

  
{% endblock %}
