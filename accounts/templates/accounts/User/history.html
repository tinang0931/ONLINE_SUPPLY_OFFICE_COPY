{% extends "accounts/User/main.html" %}

{% load static %}

{% block history %}

<div class="container-fluid" style=" height: 68vh; overflow-y: auto; overflow-x: hidden;">
  <div class="container">
    <h1 class="pr text-center pt-4">PURCHASE REQUEST HISTORY</h1>


    <div class="col-6 col-sm-6 col-md-5 col-lg-3">
      <input class="form-control" type="text" placeholder="Search" id="search_bar_request">
    </div>
    <div class="table-responsive" style="margin: 0 auto;">
        <table class="table" id="create_request_table" style="border: 1px solid black;">
          <thead>
            <tr>
              <th class="text-nowrap" style="min-width: 15rem;">Purchase Request ID</th>
              <th class="text-nowrap" style="min-width: 7rem;">Date Requested</th>
              <th class="text-nowrap" style="min-width: 7rem;">Item Name</th>
              <th class="text-nowrap" style="min-width: 7rem;">Quantity</th>
              <th class="text-nowrap" style="min-width: 7rem;">Status Description</th>
              <th class="text-nowrap" style="min-width: 7rem;">Total Cost</th>
              <th class="text-center text-nowrap"></th>
            </tr>
          </thead>
          <tbody>
            {% for item in items %}
            <tr class="item-row">
              <td style="text-align: center;">
                <span class="item-no">{{ item.request_id }}</span>
            </td>
              <td>{{ item.submission_date }}</td>
              <td>{{item.item}}</td>
              <td>{{item.quantity}}</td>
              <td>Verify Papers submitted</td>
              <td class="item_total_cost text-center">
                {{ item.total_cost }}
              </td>
              <td class="text-end my-2 mt-0">
                <html lang="en">

</html>

<button type="button" class="btn btn-link btn-sm show-details-btn" data-request-id="{{ item.request_id }}">
  Show More Details
</button>

<form id="purchase-approval-form" style="display: none;">
  <!-- Purchase Approval Form fields go here -->
  Purchase Approval Form
</form>

<form id="resolution-approval-form" style="display: none;">
  <!-- Resolution Approval Form fields go here -->
  Resolution Approval Form
</form>

<form id="other-form" style="display: none;">
  <!-- Other Form fields go here -->
  Other Form
</form>

<script>
  function displayForm(formType, response) {
      // Your logic to dynamically display the form based on the formType
      // You may want to implement a more sophisticated way to display forms

      // Hide all forms initially
      document.getElementById('purchase-approval-form').style.display = 'none';
      document.getElementById('resolution-approval-form').style.display = 'none';
      document.getElementById('other-form').style.display = 'none';

      // Show the form based on formType
      switch (formType) {
          case 'purchase_approval':
              document.getElementById('purchase-approval-form').style.display = 'block';
              break;
          case 'resolution_approval':
              document.getElementById('resolution-approval-form').style.display = 'block';
              break;
          case 'other':
              document.getElementById('other-form').style.display = 'block';
              break;
          default:
              alert('Unknown form type');
      }
  }
</script><script id="purchase-approval-template" type="text/html">
  <form id="purchase-approval-form">
      <!-- Purchase Approval Form fields go here -->
      <label for="purchase-approval-field">Purchase Approval Field:</label>
      <input type="text" id="purchase-approval-field" name="purchase_approval_field">
      <button type="submit">Submit</button>
  </form>
</script>

<!-- resolution-approval-template -->
<script id="resolution-approval-template" type="text/html">
  <form id="resolution-approval-form">
      <!-- Resolution Approval Form fields go here -->
      <label for="resolution-approval-field">Resolution Approval Field:</label>
      <input type="text" id="resolution-approval-field" name="resolution_approval_field">
      <button type="submit">Submit</button>
  </form>
</script>

<!-- other-template -->
<script id="other-template" type="text/html">
  <form id="other-form">
      <!-- Other Form fields go here -->
      <label for="other-field">Other Field:</label>
      <input type="text" id="other-field" name="other_field">
      <button type="submit">Submit</button>
  </form>
</script>
<script>
  function displayForm(formType, response) {
      // Clear existing content
      document.getElementById('form-container').innerHTML = '';

      // Get the template based on formType
      var templateId = formType + '-template';
      var templateSource = document.getElementById(templateId).innerHTML;

      // Compile the template
      var template = Handlebars.compile(templateSource);

      // Render the template with the response data
      var renderedHtml = template(response);

      // Append the rendered form to the container
      document.getElementById('form-container').innerHTML = renderedHtml;
  }
</script>
<div id="form-container"></div>

                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        
        </table>
    </div>
  </div>
</div>

{% endblock %} 
