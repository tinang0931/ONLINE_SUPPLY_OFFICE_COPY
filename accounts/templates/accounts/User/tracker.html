{% extends "accounts/User/main.html" %}

{% block tracker %}
<style>
  .custom-f{
    display: flex;
    justify-content: center;
  }

  .pad{
    padding: 0px!important;
  }

  .item-received {
  margin: 20 auto;
}

</style>

<div class="container-fluid" style="height: 68vh; overflow-y: auto; overflow-x: hidden;">
  <div class="container">
    <h1 class="pr text-center pt-4">REQUEST STATUS</h1>
  </div>
  <div class="container" style="display: inline-flex; margin: 3; flex-direction: column;">
    <div style="display: flex; align-items: baseline; flex-wrap: nowrap;">
    </div>
  </div>
  <div class="custom-f row w-100 m-auto border text-start text-dark">
    <div class="pad col">
      <table class="table table-bordered" style="margin: 0px!important;">
        <thead>
          <tr>
            <th>Purchase Request No.</th>
            <th>Purpose </th>
            <th>Forms</th>
            <th>Status</th>
            <th>Date</th>
            
          </tr>
        </thead>
        <tbody>
          {% for item in feedback %}
    <tr>
        <td>{{ item.pr_id }}</td>
        
        <!-- Debugging: Display the checkout_info for the current item -->
        {% for i in checkout_info %}
            {% if i.pr_id == item.pr_id %}
                <td>{{ i.purpose }}</td>
                
            {% endif %}
        {% endfor %}

        <td>Purchase Request Approval</td>
        <td class="badge bg-success" style="margin-top: 5px; margin-left: 5px; color: rgb(240, 230, 230);">
          {{ item.content }}</td>
        <td>{{ item.timestamp }}</td>
    </tr>

    {% if feedback|length == 0 %}
    <tr>
        <td colspan="3">
            <span >NO REQUEST YET</span>
        </td>
    </tr>
{% endif %}

<tbody>
  {% for item in feedback %}
    <tr>
      <td>{{ item.pr_id }}</td>

      <!-- Display the purpose from "preqform" or "bohome" -->
      {% for i in checkout_info %}
        {% if i.pr_id == item.pr_id %}
          <td>{{ i.purpose }}</td>
        {% endif %}
      {% endfor %}

      <td>Purchase Request Approval</td>

      <!-- Display the status and timestamp -->
      <td class="badge bg-success" style="margin-top: 5px; margin-left: 5px; color: white;">
        {% if item.status_comment %}
          {{ item.status_comment }}
        {% else %}
          {{ item.content }}
        {% endif %}
      </td>

      <td>{{ item.status_update_date|default:item.timestamp }}</td>

      <!-- Display the approval status -->
      <td class="badge {% if item.is_approve %}bg-success{% else %}no-comment{% endif %}" style="margin-top: 5px; margin-left: 5px; color: black;">
        {% if item.is_approve %}
          Approved
        {% else %}
          Disapproved
        {% endif %}
      </td>
    </tr>
  {% endfor %}

  {% if feedback|length == 0 %}
    <tr>
      <td colspan="3">
        <span>NO REQUEST YET</span>
      </td>
    </tr>
  {% endif %}

{% endfor %}

         
        </tbody>
      </table>
      
    </div>
  </div>
</div>


</script>

{% endblock %}
