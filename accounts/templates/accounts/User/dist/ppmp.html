
{% extends "accounts/User/main2.html" %}

{% load static %}

{% block ppmp %}

<div class="ppmp">
    <div class="ppmp-button">
        <ul>
            <li><a href="{% url 'catalogue' %}">Catalogue</a></li>
            <li><a href="">2024 PPMP</a></li>
        </ul>
    </div>

    <div class="ppmp-form">
        <form action="" method="post">
            <div class="form-row">
                <select id="yearDropdown">
                    <option selected>Select Year</option>
                    <option value="2022">2022</option>
                    <option value="2023">2023</option>
                    <option value="2024">2024</option>
                    <option value="2025">2025</option>
                    <option value="2026">2026</option>
                    <option value="2027">2027</option>
                </select>
                <input type="hidden" id="selectedYear" name="selectedYear">
                <div class="ppmp-budget">
                    <h2>Total Allocated Budget:</h2>
                    <span id="total_allocated_budget">
                        <h2 class="ppmp-budget-amount">â‚± 15000.00</h2>
                    </span>
                </div>
    
                

            </div>

            <div class="table-responsive">
                <table class="ppmp-table">
                    <thead>
                        <tr>
                           
                            <th rowspan='2' class="text-center">Item Name</th>
                            <th rowspan='2' class="text-center">Brand / Description</th>
                            <th rowspan='2' class="text-center">Unit</th>
                            <th rowspan='2' class="text-center">Estimated Budget</th>
                            <th colspan="12" class="text-center">Monthly Quantity Requirement</th>
                            <th rowspan='2' class="text-center">Unit Price</th>
                            <th rowspan="2" class="text-center">Action</th>
                        </tr>
                        <tr>
                            <th>Jan</th>
                            <th>Feb</th>
                            <th>Mar</th>
                            <th>April</th>
                            <th>May</th>
                            <th>June</th>
                            <th>July</th>
                            <th>Aug</th>
                            <th>Sept</th>
                            <th>Oct</th>
                            <th>Nov</th>
                            <th>Dec</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for p in items %}
                        <tr class="item-row" id="{{ p.id }}">
                            <td class="text-center">{{ forloop.counter }}</td>
                            <td class="text-left">
                                <span class="editable" data-field="Item_name">{{ p.item }}</span>
                                <input id="item_{{ p.id }}" name="item" type="text" value="{{ p.item }}"
                                    oninput="change_val('item_{{ p.id }}')" class="edit-input" style="display: none">
                            </td>
                            <td class="text-left">
                                <span class="editable" data-field="Item_Brand">{{ p.item_brand_description }}</span>
                                <input id="item_brand_{{ p.id }}" name="item_brand" type="text"
                                    value="{{ p.item_brand_description }}" oninput="change_val('item_brand_{{ p.id }}')"
                                    class="edit-input" style="display: none">
                            </td>
                            <td class="text-left">
                                <span class="editable" data-field="Unit">{{ p.unit }}</span>
                                <input id="unit_{{ p.id }}" name="unit" type="text" value="{{ p.unit }}"
                                    oninput="change_val('unit_{{ p.id }}')" class="edit-input" style="display: none">
                            </td>
                            <td><input type="number" name="estimate_budget"></td>
                            <td><input type="number" style="width: 38px;" name="jan" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="feb" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="mar" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="apr" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="may" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="jun" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="jul" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="aug" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="sep" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="oct" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="nov" value="0"></td>
                            <td><input type="number" style="width: 38px;" name="dec" value="0"></td>
                            <td>
                                <span class="editable" data-field="Price">{{ p.unit_cost }}</span>
                                <input id="price_{{ p.id }}" name="price" type="number" value="{{ p.unit_cost }}"
                                    oninput="change_val('price_{{ p.id }}')" class="edit-input" style="display: none">
                            </td>
                            <td>
                                <div class="item-actions" style="margin-left: 17px;">
                                    {% if p.id %}
                                    <a href="{% url 'delete' p.id %}" class="delete-icon delete-item" data-id="{{ p.id }}">
                                        <i class="fas fa-trash text-danger"></i>
                                    </a>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                        <tr id="new-item-row-{{ category }}" style="display: none;">
                            <td class="text-center"></td>
                            <form method="post" action="{% url 'user_add_new_item' %}">
                                {% csrf_token %}
                                <td>
                                    <input type="text" name="new_item_name" placeholder="New Item Name" required>
                                </td>
                                <td>
                                    <input type="text" name="new_item_brand" placeholder="New Item Brand/Description" required>
                                </td>
                                <td>
                                    <input type="text" name="new_item_unit" placeholder="New Item Unit" required>
                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>
                                    <input type="number" name="item_unit_price" placeholder="Item Unit Price">
                                </td>
                                <td>
                                    <button type="submit" class="save-btn btn-success" style="background: none; border: none;"
                                        title="Save" onclick="saveFunction()">
                                        <i class="fas fa-save" style="color: #28a745; background-color: #003566;"></i>
                                    </button>
                                </td>
                            </form>
                        </tr>
                    </tbody>
                </table>
            
                <button type="button" class="add-btn btn-primary btn-sm float-left mt-2 mb-2"
                        id="add-btn-{{ category }}" onclick="toggleNewItemRow('{{ category }}')">
                    <i class="fas fa-plus-circle"></i>
                </button>
            
                <button id="submitBtn" type="button" class="btn btn-success btn-sm m-2"
                        style="color: #FFA500; background-color: #22507A; border-color: #007bff; 
                               height: 43px; width: 130px; position: fixed; top: 85vh; right: 20px;"
                        onclick="submitForm()"> 
                    <i class="fas fa-check-circle"></i> Submit
                </button>
            
                <div class="total" style="position: absolute; top: 55vh; left: 135vh; transform: translateX(-50%); display: flex; align-items: center;">
                    <label for="estimate_budget" style="margin-right: 10px;">
                        <strong>TOTAL AMOUNT :</strong>
                    </label>
                    <input type="number" name="estimate_budget" id="estimate_budget" readonly>
                </div>
                </form>
        

        </form>
    <div>
</div>



{% endblock %}